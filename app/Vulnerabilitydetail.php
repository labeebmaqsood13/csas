<?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Vulnerabilitydetail extends Model
{
	public $table = 'vulnerabilities_detail';
	protected $fillable = ['vulnerability', 'description', 'solution'];


	public function store($plugin_name_array){

		foreach($plugin_name_array as $each){
			Vulnerabilitydetail::create([
					'vulnerability' => $each[0],
					'description'   => $each[1],
					'solution'		=> $each[2],
				]);
		}	

	}

    public function read(){

		$vulnerabilities_detail = $this->all();
		return $vulnerabilities_detail;

    }

    public function vulnerabilitydetail_ip_mac(){

    	// Each vulnerability has one or many ips and mac.
        return $this->hasMany('App\Vulnerabilitydetail_ip_mac');

    }
}
